(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{85:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return s})),r.d(t,"metadata",(function(){return o})),r.d(t,"rightToc",(function(){return c})),r.d(t,"default",(function(){return b}));var a=r(2),n=r(6),i=(r(0),r(99)),s={id:"observables",title:"Observables"},o={unversionedId:"basics/observables",id:"version-0.0.4/basics/observables",isDocsHomePage:!1,title:"Observables",description:"Sort of like selectors, except not",source:"@site/versioned_docs/version-0.0.4/basics/observables.md",permalink:"/rx-store/docs/basics/observables",editUrl:"https://github.com/rx-store/rx-store/edit/master/website/versioned_docs/version-0.0.4/basics/observables.md",version:"0.0.4",sidebar:"version-0.0.4/someSidebar",previous:{title:"Subjects",permalink:"/rx-store/docs/basics/subjects"},next:{title:"Effects",permalink:"/rx-store/docs/basics/effects"}},c=[{value:"Sort of like selectors, except not",id:"sort-of-like-selectors-except-not",children:[]},{value:"Building up streams",id:"building-up-streams",children:[]},{value:"Example",id:"example",children:[]},{value:"Imperative Example",id:"imperative-example",children:[]},{value:"Declarative Example",id:"declarative-example",children:[]},{value:"Uni-cast vs Multi-cast",id:"uni-cast-vs-multi-cast",children:[]}],l={rightToc:c};function b(e){var t=e.components,r=Object(n.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},l,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"sort-of-like-selectors-except-not"},"Sort of like selectors, except not"),Object(i.b)("p",null,"With other state management like Redux, you receive the top level state and must pare it down to select just the part(s) of the state you need. The pared down state is then diffed immutably, which has various pitfalls like running every ",Object(i.b)("inlineCode",{parentName:"p"},"mapStateToProps")," on every change to any state, and re-rendering large lists when only one element changed in a large array."),Object(i.b)("h2",{id:"building-up-streams"},"Building up streams"),Object(i.b)("p",null,'With observables, we will work backwards from the stream we want by building "up" lower level streams.'),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"We can combine multiple streams, for example with ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://rxjs-dev.firebaseapp.com/api/index/function/merge"}),"merge"),", or ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://rxjs-dev.firebaseapp.com/api/index/function/combineLatest"}),"combineLatest"),","),Object(i.b)("li",{parentName:"ul"},"We can transform values, for example with ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://rxjs-dev.firebaseapp.com/api/operators/bufferTime"}),"bufferTime")," or ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://rxjs-dev.firebaseapp.com/api/operators/map"}),"map")),Object(i.b)("li",{parentName:"ul"},"We can reduce a stream of events to a latest state with ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://rxjs-dev.firebaseapp.com/api/operators/scan"}),"scan")),Object(i.b)("li",{parentName:"ul"},"So much more!")),Object(i.b)("h2",{id:"example"},"Example"),Object(i.b)("p",null,"Here we create an observable ",Object(i.b)("inlineCode",{parentName:"p"},"bothClick$"),". Just like subjects, it can be subscribed to, however there is no ",Object(i.b)("inlineCode",{parentName:"p"},".next()")," method."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),"const myClicks$ = new Subject();\nconst yourClicks$ = new Subject();\n\n// observable derived from 2 subjects:\nconst bothClicks$ = merge(myClick$, yourClick$).pipe(delay(100));\n\nconst store = {\n  myClick$,\n  yourClick$,\n  bothClick$,\n};\n")),Object(i.b)("h2",{id:"imperative-example"},"Imperative Example"),Object(i.b)("p",null,"As you learn RxJs, if you ever get stuck, you can always revert to writing imperative code, for example with the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://rxjs-dev.firebaseapp.com/guide/observable#creating-observables"}),"observable constructor")," which may look familiar if you're experienced with the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/Promise"}),"promise constructor"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),"const timer$ = new Observable((subscriber) => {\n  let i = 0;\n  const int = setInterval(() => {\n    i++;\n    subscriber.next(i);\n  }, 1000);\n  return () => clearInterval(int);\n});\n\nconst store = {\n  timer$,\n};\n")),Object(i.b)("h2",{id:"declarative-example"},"Declarative Example"),Object(i.b)("p",null,"Its often much nicer to make it declarative! This does the same thing!"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),"const store = {\n  timer$: interval(1000),\n};\n")),Object(i.b)("h2",{id:"uni-cast-vs-multi-cast"},"Uni-cast vs Multi-cast"),Object(i.b)("p",null,"Each subscriber will get its own instance of stream state. In both of the above two examples, each time you ",Object(i.b)("inlineCode",{parentName:"p"},"subscribe()")," to ",Object(i.b)("inlineCode",{parentName:"p"},"timer$"),", it runs a new ",Object(i.b)("inlineCode",{parentName:"p"},"setInterval()"),", and each time you ",Object(i.b)("inlineCode",{parentName:"p"},"unsubscribe()")," it runs the corresponding ",Object(i.b)("inlineCode",{parentName:"p"},"clearInterval()"),". You will have ",Object(i.b)("inlineCode",{parentName:"p"},"N")," number of intervals going, where ",Object(i.b)("inlineCode",{parentName:"p"},"N")," is the number of subscriptions. Each subscription's callback will run in a separate tick of the event loop."),Object(i.b)("p",null,"You could use the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://rxjs.dev/api/operators/share"}),"share")," operator in your observable pipeline, which internally uses a subject, it would make all subscribers share a single ",Object(i.b)("inlineCode",{parentName:"p"},"setInterval")," callback running in the same event loop tick."),Object(i.b)("p",null,"For more on ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://rxjs-dev.firebaseapp.com/guide/subject#multicasted-observables"}),"multi casting, see the RxJs docs.")))}b.isMDXComponent=!0},99:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var a=r(0),n=r.n(a);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=n.a.createContext({}),b=function(e){var t=n.a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=b(e.components);return n.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},m=n.a.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=b(r),m=a,d=p["".concat(s,".").concat(m)]||p[m]||u[m]||i;return r?n.a.createElement(d,o(o({ref:t},l),{},{components:r})):n.a.createElement(d,o({ref:t},l))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,s=new Array(i);s[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var l=2;l<i;l++)s[l]=r[l];return n.a.createElement.apply(null,s)}return n.a.createElement.apply(null,r)}m.displayName="MDXCreateElement"}}]);